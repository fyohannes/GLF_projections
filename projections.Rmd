---
title: "GLF Projections"
author: "Feven Yohannes"
date: "June 24, 2020"
output: html_document
---

```{r setup, include=FALSE,warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(readr)
library(dbplyr)
library(devtools)
library(googlesheets4)
library(knitr)
library(tidyr)
library(moderndive)
library(purrr)
library(ggplot2)
library(gt)
library(infer)
library(janitor)
library(ggpubr)

# Using this for my projections graph

library(growthrates)

# Using this for growth projections

library(tidyverse)
```

```{r,reading in the data,message=FALSE}

dir.create("raw-data")

# I created a raw data directory.

data <-read_csv("raw-data/boston_data - Beneficiaries Served (H - Rows.csv", col_types = cols(
  `Reporting Year` = col_character(),
  Organization = col_character(),
  `Program Year` = col_double(),
  `Portfolio Status` = col_character(),
  `Actual Served` = col_double(),
  `Target Served` = col_double(),
  `% of Target Served` = col_character()
  ))

# Downloaded the googlesheets

data <- data %>% clean_names()

# Cleaning names


```

```{r,Friends of the Children}

 data1 <- data %>% 
  filter(organization == "Friends of the Children (FOC BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

#Splitting the year

# Filtering for just Friends of the Children

data1 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col() +
  labs(title ="Growth of Friends of the Children from 2005 - 2018",
        subtitle="An active portfolio organization of Greenlight Fund from 2005-2010", caption = "Caption: Analyzing the growth in the number of beneficiaries served by Friends of the Children in Boston ",
    x="Year",y= "Number of Beneficiaries",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(legend.title = element_text(color = "gray1", size = 8),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +theme(axis.text.x = element_text( 
    angle = 70, 
    size=10,  
    face=3)
  ) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))

  
  
  

```

```{r,Rasing a Reader}

 data2 <- data %>% 
  filter(organization == "Raising A Reader - MA (RARMA BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

#Splitting the year

# Filtering for just Rasing a Reader

data2 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col() + scale_fill_gradient(
low = "red",
high = "yellow3") +
  labs(title ="Growth of Raising a Reader from 2006 - 2019",
        subtitle="An active portfolio organization of Greenlight Fund from 2006 - 2011",
    x="Year",y= "Number of Beneficiaries",
    caption = "Caption: Analyzing the growth in the number of beneficiaries served by Rasing a Reader in Boston ",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(legend.title = element_text(color = "gray1", size = 8),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +theme(axis.text.x = element_text( 
    angle = 70, 
    size=10,  
    face=3)
  ) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))

  

```

```{r,Peer Health Exchange}

data3 <- data %>% 
  filter(organization == "Peer Health Exchange (PHE BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

#Splitting the year

# Filtering for just Peer Health Exchange

data3 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()  + scale_fill_gradient(
low = "pink",
high = "plum4") +
  labs(title ="Growth of Peer Health Exchange 2007 - 2018",
        subtitle="An active portfolio organization of Greenlight Fund from 2007 - 2011",
    x="Year",y= "Number of Beneficiaries",
    caption = "Caption: Analyzing the growth in the number of beneficiaries served by Peer Health Exchange in Boston",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(legend.title = element_text(color = "gray1", size = 8),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +theme(axis.text.x = element_text( 
    angle = 70, 
    size=10,  
    face=3)
  ) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))
  

```
```{r, Youth Villages}

data4 <- data %>% 
  filter(organization == "Youth Villages (YV BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

#Splitting the year

# Filtering for just Youth Villages

data4 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col() + scale_fill_gradient(
low = "seagreen4",
high = "palegreen") +
  labs(title ="Growth of Youth Villages 2009 - 2018",
        subtitle="An active portfolio organization of Greenlight Fund from 2009 - 2012",
       caption = "**Caption**: Analyzing the growth in the number  of beneficiaries \n served by Youth Villages in Boston",
    x="Year",y= "Number of Beneficiaries",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(legend.title = element_text(color = "gray1", size = 10),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))
  
  

```

```{r, Family Indepednce Initative}

data5 <- data %>% 
  filter(organization == "Family Independence Initiative (FII BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

#Splitting the year

# Filtering for just Family Independence Initiative

data5 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()   + scale_fill_gradient(
low = "skyblue1",
high = "royalblue2") +
  labs(title ="Growth of Family Independence Initiative 2011 - 2019",
        subtitle="An active portfolio organization of Greenlight's from 2011 - 2015",
    x="Year",y= "Number of Beneficiaries",
    caption = "Caption: Analyzing the growth in the number  of beneficiaries \n served by Family Independence Initiative in Boston",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(legend.title = element_text(color = "gray1", size = 10),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))
  
```

```{r, Single Stop USA}

data6 <- data %>% 
  filter(organization == "Single Stop USA (SSUSA BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

#Splitting the year

# Filtering for just Single Stop USA

data6 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()  + scale_fill_gradient(
low = "tomato1",
high = "brown4") +
  labs(title ="Growth of Single Stop USA 2011 - 2019",
        subtitle="An active portfolio organization of Greenlight's from 2011 - 2016",
    x="Year",y= "Number of Beneficiaries",
    caption = "Caption: Analyzing the growth in the number of beneficiaries \n served by Single Stop USA in Boston",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(legend.title = element_text(color = "gray1", size = 10),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))
```
```{r, Blueprint School Network}

data7 <- data %>% 
  filter(organization == "Blueprint Schools Network (BSN BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

# Splitting the year

# Filtering for just Blueprint

data7 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()  + scale_fill_gradient(
low = "goldenrod3",
high = "darkorange2") +
  labs(title ="Blueprint Schools Network 2011 - 2019",
        subtitle="An active portfolio organization of Greenlight's from 2011 - 2016",
    x="Year",y= "Number of Beneficiaries",
    caption = "Caption: Analyzing the growth in the number of beneficiaries \n served by Blueprint School's Network in Boston",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(legend.title = element_text(color = "gray1", size = 10),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))



```

```{r,College Advising Corps}

data8 <- data %>% 
  filter(organization == "College Advising Corps (CAC BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

# Splitting the year

# Filtering for just College Advising Corps

data8 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()  + scale_fill_gradient(
low = "slategray2",
high = "plum3")+
  labs(title ="Number of Beneficiaries served from 2013 - 2019",
        subtitle="An active portfolio organization of Greenlight's from 2013 - 2018",
    x="Year",y= "Number of Beneficiaries",
    caption = "Caption: Analyzing the growth in the number of beneficiaries \n served by College Advising Corps in Boston",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(legend.title = element_text(color = "gray1", size = 10),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))





```

```{r,New Teacher Center}

data9 <- data %>% 
  filter(organization == "New Teacher Center (NTC BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

# Splitting the year

# Filtering for just New Teacher's Center

data9 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()  + scale_fill_gradient(
low = "coral1",
high = "coral4")+
  labs(title ="Number of Beneficiaries served from 2013 - 2016",
        subtitle="An active portfolio organization of Greenlight's from 2013 - 2016",
    x="Year",y= "Number of Beneficiaries",
    caption = "Caption: Analyzing the growth in the number of beneficiaries \n served by New Teacher Center in Boston",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold"))  +
  theme(legend.title = element_text(color = "gray1", size = 10),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic"))


```

```{r, CareMessage}

data10 <- data %>% 
  filter(organization == "CareMessage (CM BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

# Splitting the year

# Filtering for just CareMessage

data10 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()  + scale_fill_gradient(
low = "thistle3",
high = "violet") +
  labs(title ="Number of Beneficiaries that CareMessage served from 2016 - 2019",
        subtitle="An active portfolio organization of Greenlight Fund from 2016 - 2019",
    x="Year",y= "Number of Beneficiaries",
    caption = "Caption: Analyzing the growth in the number of beneficiaries \n served by CareMessage in Boston",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold",size=12)) +
  theme(legend.title = element_text(color = "gray1", size = 10),legend.key.width = unit(0.8,"cm"),legend.key.size = unit(1, "cm")) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic",size=10)) +
  scale_y_continuous(name="Fluorescent intensity/arbitrary units", labels = scales::comma) +
  geom_text(aes(label = actual_served), vjust = 0) 
    


```

```{r,Youth Guidance (BAM)}

data11 <- data %>% 
  filter(organization == "Youth Guidance (BAM BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

# Splitting the year

# Filtering for just BAM

data11 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()  + scale_fill_gradient(
low = "palegreen1",
high = "palegreen3")+
  labs(title ="Number of Beneficiaries that BAM served from 2017 - 2019",
        subtitle="An active portfolio organization of Greenlight's from 2017 - 2019",
          caption = "Caption: Analyzing the growth in the number of beneficiaries \n served by BAM in Boston",
    x="Year",y= "Number of Beneficiaries",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold")) +
  theme(
    plot.caption = element_text(hjust = 0, face = "italic",size=10))



```

```{r, Per Scholas}


data12 <- data %>% 
  filter(organization == "Per Scholas (PS BOS)") %>%
  separate(reporting_year, c("start_year", "end_year")) %>%
  drop_na(actual_served)

# Splitting the year

# Filtering for just Per Scholas

data12 %>%
  ggplot(aes(x=start_year, y=actual_served,fill=actual_served)) + geom_col()  + scale_fill_gradient(
low = "salmon4",
high = "salmon1") +
  labs(title ="Number of Beneficiaries that Per Scholas served in 2019",
        subtitle="An active portfolio organization of Greenlight's since 2019",
    x="Year",y= "Number of Beneficiaries",
    fill = "Number of Beneficiaries Served") +
  theme(plot.title = element_text(face = "bold"))



```


```{r, Adding up all organization averages from the last three years}

# Yearly Growth for existing organizations both Active and Legacy
# 50,138 is Care Message's Average Growth, but this is an incredibly modest projection, likelihood is that it will exceed 150,000 beneficiaries served

```

```{r, projections by Organization, Friends of the Children,124}

  # Friends of the Children
  # Progam Years 14,13,12,11,10 are the last five years of data. This is what is being used to find average growth of beneficiaries served.


# Filtering for Friends of the Children

dataA <- data %>%
filter(organization == "Friends of the Children (FOC BOS)") %>%

# Calculating the growth rate for each year

growthA <- dataA %>%
  arrange(reporting_year) %>%
  mutate(diff_year = program_year - lag(program_year)) %>%
  mutate(diff_growth = actual_served - lag(actual_served)) %>%
  mutate(rate_percent = (diff_growth /diff_year)/ lag(actual_served) * 100)

# Calculating the average growth rate for the last five years

growthA <- growthA %>%
  filter(program_year %in% c("14","13","12","11","10")) %>%
  mutate(avg_growth_rate = mean(rate_percent))


# Calculating projections for the next 5 years

 (138 * 1.455431)

(200.8495 * 1.455)






# Year 2019-2020 : 200.8495
# Year 2020-2021 : 292.236
# Year 2021-2022 : 178.5
# Year 2022-2023 : 192
# Year 2023-2024 : 205.5
```

```{r, Projections for each Org, Raising a Reader,10407}

  # Rasing a Reader
  # Progam Years 13,12,11 are the last three years of data. This is what is being used to find average growth of beneficiaries served.

dataB <- data %>%
filter(organization == "Raising A Reader - MA (RARMA BOS)") %>%
filter(program_year %in% c("13","12","11")) %>%
mutate(total_served = sum(actual_served,na.rm=TRUE)) %>%
mutate(average= total_served/3)

# Coordinates 
# (1,13000) (3,8500)


```

```{r, Portfolio Organizations, Peer Health Exchange,3268}
  # Peer Health Exchange
  # Progam Years 11,10,9 are the last three years of data. This is what is being used to find average growth of beneficiaries served.

dataC <- data %>%
filter(organization == "Peer Health Exchange (PHE BOS)")  %>%
filter(program_year %in% c("11","10","9")) %>%
mutate(total_served = sum(actual_served,na.rm=TRUE)) %>%
mutate(average= total_served/3)


```

```{r, Portfolio Orgs, Youth Villages,241}

 # Youth Villages 
  # Progam Years 10,9,8 are the last three years of data. This is what is being used to find average growth of beneficiaries served.

  
dataD <- data %>%
filter(organization == "Youth Villages (YV BOS)") %>%
filter(program_year %in% c("10","9","8")) %>%
mutate(total_served = sum(actual_served,na.rm=TRUE)) %>%
mutate(average= total_served/3)

```

```{r, Portfolio Organizations, Family Independence Iniative,3348}

 # Family Independence Iniative
  # Progam Years 8,7,6 are the last three years of data. This is what is being used to find average growth of beneficiaries served.

  
dataE <- data %>%
filter(organization == "Family Independence Initiative (FII BOS)") %>%
filter(program_year %in% c("8","7","6")) %>%
mutate(total_served = sum(actual_served,na.rm=TRUE)) %>%
mutate(average= total_served/3)
```

```{r,Portfolio Organization, Single Stop,9604}

# Single Stop
  # Progam Years 8,7,6 are the last three years of data. This is what is being used to find average growth of beneficiaries served.

  
dataF <- data %>%
filter(organization == "Single Stop USA (SSUSA BOS)") %>% 
filter(program_year %in% c("8","7","6")) %>%
mutate(total_served = sum(actual_served,na.rm=TRUE)) %>%
mutate(average= total_served/3)
```

```{r, Portfolio Organization, College Advising Corps,16922}

# College Advising Corps
  # Progam Years 6,5,4 are the last three years of data. This is what is being used to find average growth of beneficiaries served.
  
dataG <- data %>%
filter(organization == "College Advising Corps (CAC BOS)") %>%
filter(program_year %in% c("6","5","4")) %>%
mutate(total_served = sum(actual_served,na.rm=TRUE)) %>%
mutate(average= total_served/3)
```

```{r, Portfolio Organizations,Care Message,50138}

# Care Message
  # Progam Years 3,2,1 are the last three years of data. This is what is being used to find average growth of beneficiaries served.
  
dataH <- data %>%
filter(organization == "CareMessage (CM BOS)") %>%
filter(program_year %in% c("3","2","1")) %>%
mutate(total_served = sum(actual_served,na.rm=TRUE)) %>%
mutate(average= total_served/3)
```

```{r, Portfolio Organizations,BAM,169}

# BAM/Youth Guidance
  # Progam Years 2 and 1 are the last two years of data. This is what is being used to find average growth of beneficiaries served.
  
dataI <- data %>%
filter(organization == "Youth Guidance (BAM BOS)") %>%
filter(program_year %in% c("3","2","1")) %>%
mutate(total_served = sum(actual_served,na.rm=TRUE)) %>%
mutate(average= total_served/3)
```


